<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
  <meta charset="UTF-8">
  <title>Fractide Demo</title>
  <style>
    body {
      margin: 0;
      background: #111;
      overflow: hidden;
    }
    canvas {
      display: block;
      margin: 0 auto;
      background: radial-gradient(circle at center, #222, #000);
    }
  </style>
</head>
<body>
<canvas id="gameCanvas"></canvas>
<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let player = {
  x: canvas.width/2,
  y: canvas.height/2,
  radius: 20,
  speed: 4,
  color: "#4af"
};

let keys = {};
let fragments = [];

function spawnFragments(num=50) {
  for (let i=0;i<num;i++) {
    fragments.push({
      x: Math.random()*canvas.width,
      y: Math.random()*canvas.height,
      radius: 5,
      color: "#fa4"
    });
  }
}
spawnFragments();

function drawPlayer() {
  ctx.beginPath();
  ctx.arc(player.x, player.y, player.radius, 0, Math.PI*2);
  ctx.fillStyle = player.color;
  ctx.fill();
}

function drawFragments() {
  fragments.forEach(f=>{
    ctx.beginPath();
    ctx.arc(f.x, f.y, f.radius, 0, Math.PI*2);
    ctx.fillStyle = f.color;
    ctx.fill();
  });
}

function movePlayer() {
  if (keys["w"] || keys["ArrowUp"]) player.y -= player.speed;
  if (keys["s"] || keys["ArrowDown"]) player.y += player.speed;
  if (keys["a"] || keys["ArrowLeft"]) player.x -= player.speed;
  if (keys["d"] || keys["ArrowRight"]) player.x += player.speed;
}

function checkCollisions() {
  for (let i=fragments.length-1;i>=0;i--) {
    let f = fragments[i];
    let dx = player.x - f.x;
    let dy = player.y - f.y;
    let dist = Math.sqrt(dx*dx+dy*dy);
    if (dist < player.radius + f.radius) {
      player.radius += 1; // grow
      fragments.splice(i,1);
    }
  }
  if (fragments.length < 20) spawnFragments(30);
}

function explodePlayer() {
  for (let i=0;i<10;i++) {
    fragments.push({
      x: player.x + (Math.random()*60-30),
      y: player.y + (Math.random()*60-30),
      radius: 5+Math.random()*3,
      color: "#f55"
    });
  }
  player.radius = 20; // reset size
}

window.addEventListener("keydown", e=>{
  keys[e.key.toLowerCase()] = true;
  if (e.code==="Space") explodePlayer();
});
window.addEventListener("keyup", e=>{ keys[e.key.toLowerCase()] = false; });

function gameLoop() {
  ctx.clearRect(0,0,canvas.width,canvas.height);
  movePlayer();
  drawFragments();
  drawPlayer();
  checkCollisions();
  requestAnimationFrame(gameLoop);
}
gameLoop();
</script>
</body>
</html>
